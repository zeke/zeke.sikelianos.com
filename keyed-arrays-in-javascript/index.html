<!DOCTYPE html>
<html>

<head>
  
    <title>Objecty Arrays in JavaScript | Zeke Sikelianos</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="../index.css">
  <script src="https://unpkg.com/browser-date-formatter@3.0.2/dist.js"></script>
  <script src="../index.js"></script>
</head>

<body>

  

  <div class="site-nav">
    <a href="/">Gallery</a>
    <a href="/projects">Projects</a>
    <a href="/talks">Talks</a>
    <a href="/posts">Posts</a>
    <a href="/portfolio">Portfolio</a>
    <a href="/cv">CV</a>
    <a href="/contact">Contact</a>
  </div>

  <article>
    <div class="page__content">
      <header>
        <h1 class="page__title">Objecty Arrays in JavaScript</h1>
        
          <h2 class="page__description">Can we have our cake and eat it too?</h2>
        
        
          <div class="page__publish-date">
            
              <time title="Thu Mar 17 2016 00:00:00 GMT+0000 (Coordinated Universal Time)" data-date="Thu Mar 17 2016 00:00:00 GMT+0000 (Coordinated Universal Time)" data-format="%B %Y">Thu Mar 17 2016 00:00:00 GMT+0000 (Coordinated Universal Time)</time>
            
          </div>
        
      </header>

      <figure>
  <img src="arrays-vs-objects.svg">
</figure>
<p>The ideas in this post are implemented in the<a href="https://www.npmjs.com/package/keyed-array">keyed-array</a> package on npm.</p>
<p>A question often comes up for me when I'm designing a JavaScript or JSON data structure: "Should I use an Array or an Object for this?" Sometimes the answer is obvious. Sometimes it's hard to know which is better.</p>
<p>This short post proposes One Weird Trickâ„¢ for adding a bit of sugar to Arrays, using plain old JavaScript.</p>
<h2 id="the-data"><a href="#the-data">The Data</a></h2>
<p>Imagine you're building a JSON webservice that will return a collection of people. Each person is an object:</p>
<pre><code class="hljs language-js">{
  <span class="hljs-attr">id</span>: <span class="hljs-string">'bob'</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>,
  <span class="hljs-attr">isCool</span>: <span class="hljs-literal">false</span>
}</code></pre>
<h2 id="approach-1-array-style"><a href="#approach-1-array-style">Approach #1: 'Array' Style</a></h2>
<p>You could structure the JSON response as an array:</p>
<pre><code class="hljs language-js">people = [
  {<span class="hljs-attr">id</span>: <span class="hljs-string">'bob'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">false</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-string">'sue'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Sue'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">false</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-string">'hal'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Hal'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">true</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-string">'ann'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Ann'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">true</span>}
]</code></pre>
<p>This is nice because <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Arrays have lots of   methods</a> for dealing with collections, like <code>forEach</code>, <code>map</code>, and <code>sort</code>. Gathering up the names of all the cool people is pretty easy:</p>
<pre><code class="hljs language-js">people
  .filter(<span class="hljs-function"><span class="hljs-params">person</span> =></span> person.isCool)
  .map(<span class="hljs-function"><span class="hljs-params">person</span> =></span> person.name)</code></pre>
<p>But when you want a person with a specific id, you have to do something like this:</p>
<pre><code class="hljs language-js">people.find(<span class="hljs-function"><span class="hljs-params">person</span> =></span> person.id === <span class="hljs-string">'bob'</span>)</code></pre>
<p>Kind of cumbersome. A simple <code>people.bob</code> would be more convenient.</p>
<h2 id="approach-2-object-style"><a href="#approach-2-object-style">Approach 2: 'Object' Style</a></h2>
<p>Instead of storing the id in the object, use it as a key:</p>
<pre><code class="hljs language-js">people = {
  <span class="hljs-attr">bob</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">false</span>},
  <span class="hljs-attr">sue</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Sue'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">false</span>},
  <span class="hljs-attr">hal</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Hal'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">true</span>},
  <span class="hljs-attr">ann</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Ann'</span>, <span class="hljs-attr">isCool</span>: <span class="hljs-literal">true</span>}
}</code></pre>
<p>The nice thing about this structure is that you can easily access a person if you know their id:</p>
<pre><code class="hljs language-js">people.bob</code></pre>
<p>The drawback of this structure is that it's more cumbersome to iterate over an Object than an Array. The code for fetching the names of cool people now looks like this:</p>
<pre><code class="hljs language-js"><span class="hljs-built_in">Object</span>.keys(people)
  .filter(<span class="hljs-function"><span class="hljs-params">id</span> =></span> people[id].isCool)
  .map(<span class="hljs-function"><span class="hljs-params">id</span> =></span> people[id].name)</code></pre>
<p>Not so great.</p>
<h2 id="approach-3-the-experimental-hybrid-array"><a href="#approach-3-the-experimental-hybrid-array">Approach 3: The Experimental Hybrid Array</a></h2>
<p>Here's the crazy idea: Use an Array of person objects,
but iterate over it once at load time, assigning a key
for each person's id:</p>
<pre><code class="hljs language-js">people.forEach(<span class="hljs-function"><span class="hljs-params">person</span> =></span> people[person.id] = person)</code></pre>
<p>This way it's still an array:</p>
<pre><code class="hljs language-js"><span class="hljs-built_in">Array</span>.isArray(people) <span class="hljs-comment">// => true</span>
people[<span class="hljs-number">0</span>].name        <span class="hljs-comment">// => Bob</span>
people.length         <span class="hljs-comment">// => 4</span></code></pre>
<p>But there's now a named key for each person, so content is now addressable by id:</p>
<pre><code class="hljs language-js">people.bob.isCool     <span class="hljs-comment">// => true</span>
(<span class="hljs-string">'sue'</span> <span class="hljs-keyword">in</span> people)     <span class="hljs-comment">// => true</span></code></pre>
<p>This is kind of the best of both worlds, but there are a few drawbacks. <code>Object.keys(people).length</code> is no longer reliable, as it returns both the numeric keys of the array and the named keys we assigned:</p>
<pre><code class="hljs language-js"><span class="hljs-built_in">Object</span>.keys(people)
<span class="hljs-comment">// => ['0', '1', '2', '3', 'bob', 'sue', 'hal', 'ann']</span></code></pre>
<p>Also <code>JSON.stringify</code> will produce undesirable results. But if those two drawbacks are not important for your use case, this little technique could fit your needs.</p>
<p>If you found this useful, <a href="mailto:zeke@sikelianos.com">let me know</a>. If you think it's a bad idea, <a href="mailto:zeke@sikelianos.com">tell me why</a>.</p>
    </div>
  </article>

  <footer>
    <div class="site-nav">
      <a href="/">Gallery</a>
      <a href="/projects">Projects</a>
      <a href="/talks">Talks</a>
      <a href="/posts">Posts</a>
      <a href="/portfolio">Portfolio</a>
      <a href="/cv">CV</a>
      <a href="/contact">Contact</a>
    </div>
  </footer>
</body>
</html>